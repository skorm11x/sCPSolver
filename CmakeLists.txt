cmake_minimum_required(VERSION 3.30)
project(scpsolver)

add_executable(scpsolver src/server.cpp)

#[[target_include_directories(scpsolver PRIVATE /usr/local/include)]]

set(ORTOOLS_ROOT /usr/local)

target_include_directories(scpsolver PRIVATE
    ${ORTOOLS_ROOT}/include
)

# Link OR-Tools libraries
target_link_directories(scpsolver PRIVATE
    ${ORTOOLS_ROOT}/lib
)

target_link_libraries(scpsolver PRIVATE ortools absl_synchronization absl_base protobuf)

option(USE_STATIC_RABBITMQ "Link rabbitmq-c statically" OFF)

if(USE_STATIC_RABBITMQ)
    target_link_libraries(scpsolver PRIVATE /usr/local/lib/librabbitmq.a)
    target_compile_definitions(scpsolver PRIVATE AMQP_STATIC)
else()
    if(APPLE)
        target_link_libraries(scpsolver PRIVATE /usr/local/lib/librabbitmq.dylib)
    else()
        target_link_libraries(scpsolver PRIVATE /usr/local/lib/librabbitmq.so)
    endif()
endif()